
var __cov_Z4hGOlQHG_jI0qBRkv_7lw = (Function('return this'))();
if (!__cov_Z4hGOlQHG_jI0qBRkv_7lw.__coverage__) { __cov_Z4hGOlQHG_jI0qBRkv_7lw.__coverage__ = {}; }
__cov_Z4hGOlQHG_jI0qBRkv_7lw = __cov_Z4hGOlQHG_jI0qBRkv_7lw.__coverage__;
if (!(__cov_Z4hGOlQHG_jI0qBRkv_7lw['app/model/ProjectRepository.js'])) {
   __cov_Z4hGOlQHG_jI0qBRkv_7lw['app/model/ProjectRepository.js'] = {"path":"app/model/ProjectRepository.js","s":{"1":0,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"fnMap":{"1":{"name":"ProjectRepository","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}}},"2":{"name":"(anonymous_2)","line":17,"loc":{"start":{"line":17,"column":51},"end":{"line":17,"column":87}}},"3":{"name":"(anonymous_3)","line":31,"loc":{"start":{"line":31,"column":8},"end":{"line":31,"column":27}}},"4":{"name":"(anonymous_4)","line":34,"loc":{"start":{"line":34,"column":8},"end":{"line":34,"column":36}}},"5":{"name":"(anonymous_5)","line":36,"loc":{"start":{"line":36,"column":28},"end":{"line":36,"column":46}}},"6":{"name":"(anonymous_6)","line":53,"loc":{"start":{"line":53,"column":46},"end":{"line":53,"column":71}}},"7":{"name":"(anonymous_7)","line":61,"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":27}}},"8":{"name":"(anonymous_8)","line":64,"loc":{"start":{"line":64,"column":8},"end":{"line":64,"column":36}}},"9":{"name":"(anonymous_9)","line":66,"loc":{"start":{"line":66,"column":28},"end":{"line":66,"column":46}}},"10":{"name":"(anonymous_10)","line":79,"loc":{"start":{"line":79,"column":47},"end":{"line":79,"column":85}}},"11":{"name":"(anonymous_11)","line":90,"loc":{"start":{"line":90,"column":8},"end":{"line":90,"column":27}}},"12":{"name":"(anonymous_12)","line":93,"loc":{"start":{"line":93,"column":8},"end":{"line":93,"column":36}}},"13":{"name":"(anonymous_13)","line":108,"loc":{"start":{"line":108,"column":42},"end":{"line":108,"column":91}}},"14":{"name":"(anonymous_14)","line":122,"loc":{"start":{"line":122,"column":8},"end":{"line":122,"column":27}}},"15":{"name":"(anonymous_15)","line":125,"loc":{"start":{"line":125,"column":8},"end":{"line":125,"column":36}}},"16":{"name":"(anonymous_16)","line":140,"loc":{"start":{"line":140,"column":44},"end":{"line":140,"column":80}}},"17":{"name":"(anonymous_17)","line":152,"loc":{"start":{"line":152,"column":8},"end":{"line":152,"column":27}}},"18":{"name":"(anonymous_18)","line":155,"loc":{"start":{"line":155,"column":8},"end":{"line":155,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":6,"column":48}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":31}},"3":{"start":{"line":17,"column":0},"end":{"line":43,"column":2}},"4":{"start":{"line":18,"column":4},"end":{"line":23,"column":20}},"5":{"start":{"line":25,"column":4},"end":{"line":27,"column":6}},"6":{"start":{"line":29,"column":4},"end":{"line":42,"column":7}},"7":{"start":{"line":32,"column":12},"end":{"line":32,"column":50}},"8":{"start":{"line":35,"column":12},"end":{"line":35,"column":33}},"9":{"start":{"line":36,"column":12},"end":{"line":38,"column":15}},"10":{"start":{"line":37,"column":16},"end":{"line":37,"column":55}},"11":{"start":{"line":40,"column":12},"end":{"line":40,"column":46}},"12":{"start":{"line":53,"column":0},"end":{"line":73,"column":2}},"13":{"start":{"line":54,"column":4},"end":{"line":57,"column":17}},"14":{"start":{"line":59,"column":4},"end":{"line":72,"column":7}},"15":{"start":{"line":62,"column":12},"end":{"line":62,"column":42}},"16":{"start":{"line":65,"column":12},"end":{"line":65,"column":33}},"17":{"start":{"line":66,"column":12},"end":{"line":68,"column":15}},"18":{"start":{"line":67,"column":16},"end":{"line":67,"column":55}},"19":{"start":{"line":70,"column":12},"end":{"line":70,"column":46}},"20":{"start":{"line":79,"column":0},"end":{"line":102,"column":2}},"21":{"start":{"line":80,"column":4},"end":{"line":83,"column":17}},"22":{"start":{"line":85,"column":4},"end":{"line":87,"column":6}},"23":{"start":{"line":89,"column":4},"end":{"line":101,"column":23}},"24":{"start":{"line":91,"column":12},"end":{"line":91,"column":46}},"25":{"start":{"line":94,"column":12},"end":{"line":96,"column":13}},"26":{"start":{"line":95,"column":16},"end":{"line":95,"column":86}},"27":{"start":{"line":98,"column":12},"end":{"line":98,"column":65}},"28":{"start":{"line":99,"column":12},"end":{"line":99,"column":50}},"29":{"start":{"line":108,"column":0},"end":{"line":134,"column":2}},"30":{"start":{"line":109,"column":4},"end":{"line":114,"column":17}},"31":{"start":{"line":116,"column":4},"end":{"line":119,"column":6}},"32":{"start":{"line":121,"column":4},"end":{"line":133,"column":23}},"33":{"start":{"line":123,"column":12},"end":{"line":123,"column":46}},"34":{"start":{"line":126,"column":12},"end":{"line":128,"column":13}},"35":{"start":{"line":127,"column":16},"end":{"line":127,"column":84}},"36":{"start":{"line":130,"column":12},"end":{"line":130,"column":65}},"37":{"start":{"line":131,"column":12},"end":{"line":131,"column":50}},"38":{"start":{"line":140,"column":0},"end":{"line":163,"column":2}},"39":{"start":{"line":141,"column":4},"end":{"line":145,"column":17}},"40":{"start":{"line":147,"column":4},"end":{"line":149,"column":6}},"41":{"start":{"line":151,"column":4},"end":{"line":162,"column":23}},"42":{"start":{"line":153,"column":12},"end":{"line":153,"column":46}},"43":{"start":{"line":156,"column":12},"end":{"line":158,"column":13}},"44":{"start":{"line":157,"column":16},"end":{"line":157,"column":86}},"45":{"start":{"line":160,"column":12},"end":{"line":160,"column":40}},"46":{"start":{"line":165,"column":0},"end":{"line":165,"column":35}}},"branchMap":{"1":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":94,"column":12}},{"start":{"line":94,"column":12},"end":{"line":94,"column":12}}]},"2":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":12},"end":{"line":126,"column":12}},{"start":{"line":126,"column":12},"end":{"line":126,"column":12}}]},"3":{"line":156,"type":"if","locations":[{"start":{"line":156,"column":12},"end":{"line":156,"column":12}},{"start":{"line":156,"column":12},"end":{"line":156,"column":12}}]}}};
}
__cov_Z4hGOlQHG_jI0qBRkv_7lw = __cov_Z4hGOlQHG_jI0qBRkv_7lw['app/model/ProjectRepository.js'];
__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['1']++;var async=require('async'),config=require('../config/config'),neo4j=require('neo4j'),_=require('underscore'),Project=require('./Project'),db=new neo4j.GraphDatabase(config.db.url);function ProjectRepository(){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['1']++;}__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['3']++;ProjectRepository.prototype.listProjectsOfPerson=function(personUid,retValCallback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['2']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['4']++;var query=['MATCH (person:Person)-[r1:HAS_ROLE]->()-[r2:ON_PROJECT]->(project:Project)','WHERE person.uid = {personUid}','RETURN project'].join('\n');__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['5']++;var parameters={personUid:personUid};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['6']++;async.waterfall([function(callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['3']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['7']++;db.query(query,parameters,callback);},function(results,callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['4']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['8']++;var projectList=[];__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['9']++;_.each(results,function(project){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['5']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['10']++;projectList.push(new Project(project));});__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['11']++;retValCallback(null,projectList);}]);};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['12']++;ProjectRepository.prototype.listAllProjects=function(retValCallback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['6']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['13']++;var query=['MATCH (project:Project)','RETURN project'].join('\n');__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['14']++;async.waterfall([function(callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['7']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['15']++;db.query(query,{},callback);},function(results,callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['8']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['16']++;var projectList=[];__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['17']++;_.each(results,function(project){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['9']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['18']++;projectList.push(new Project(project));});__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['19']++;retValCallback(null,projectList);}]);};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['20']++;ProjectRepository.prototype.createNewProject=function(projectData,retValCallback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['10']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['21']++;var query=['CREATE (project:Project{projectData})','RETURN project'].join('\n');__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['22']++;var params={projectData:projectData};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['23']++;async.waterfall([function(callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['11']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['24']++;db.query(query,params,callback);},function(results,callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['12']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['25']++;if(results.length!==1){__cov_Z4hGOlQHG_jI0qBRkv_7lw.b['1'][0]++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['26']++;return retValCallback('Cannot create project with given properties.');}else{__cov_Z4hGOlQHG_jI0qBRkv_7lw.b['1'][1]++;}__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['27']++;var createdProject=new Project(results[0].project);__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['28']++;return callback(null,createdProject);}],retValCallback);};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['29']++;ProjectRepository.prototype.saveProject=function(projectId,projectData,retValCallback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['13']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['30']++;var query=['MATCH (project:Project)','WHERE id(project)={projectId}','SET project = {projectData}','RETURN project'].join('\n');__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['31']++;var params={projectId:projectId,projectData:projectData};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['32']++;async.waterfall([function(callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['14']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['33']++;db.query(query,params,callback);},function(results,callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['15']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['34']++;if(results.length!==1){__cov_Z4hGOlQHG_jI0qBRkv_7lw.b['2'][0]++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['35']++;return retValCallback('Cannot save project with given properties.');}else{__cov_Z4hGOlQHG_jI0qBRkv_7lw.b['2'][1]++;}__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['36']++;var createdProject=new Project(results[0].project);__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['37']++;return callback(null,createdProject);}],retValCallback);};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['38']++;ProjectRepository.prototype.deleteProject=function(projectId,retValCallback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['16']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['39']++;var query=['MATCH (project:Project)-[relations]-(other)','WHERE id(project)={projectId}','DELETE project, relations'].join('\n');__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['40']++;var params={projectId:projectId};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['41']++;async.waterfall([function(callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['17']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['42']++;db.query(query,params,callback);},function(results,callback){__cov_Z4hGOlQHG_jI0qBRkv_7lw.f['18']++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['43']++;if(results.length!==1){__cov_Z4hGOlQHG_jI0qBRkv_7lw.b['3'][0]++;__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['44']++;return retValCallback('Cannot create project with given properties.');}else{__cov_Z4hGOlQHG_jI0qBRkv_7lw.b['3'][1]++;}__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['45']++;return callback(null,true);}],retValCallback);};__cov_Z4hGOlQHG_jI0qBRkv_7lw.s['46']++;module.exports=ProjectRepository;
